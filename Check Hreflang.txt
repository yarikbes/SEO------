javascript:(function(){
  var SLUGS_URL='https://gist.githubusercontent.com/YOUR_USERNAME/GIST_ID/raw/slugs.json';
  
  setTimeout(function(){
    fetch(SLUGS_URL)
      .then(r=>r.json())
      .then(data=>{
        var slugMap=data.slugs;
        var hreflangs=document.querySelectorAll('link[rel="alternate"][hreflang]');
        
        if(hreflangs.length===0){
          document.cookie='showCloak=1; path=/';
          location.reload();
          return;
        }
        
        // Определяем тип текущей страницы
        var currentPath=window.location.pathname;
        var currentPageType=slugMap[currentPath];
        
        // Собираем ошибки
        var errors=[];
        var allPages=[];
        
        hreflangs.forEach(function(link){
          var href=link.getAttribute('href');
          var hreflang=link.getAttribute('hreflang');
          var url=new URL(href);
          var path=url.pathname;
          
          // Определяем тип страницы из hreflang
          var pageType=slugMap[path];
          
          allPages.push({
            href:href,
            path:path,
            hreflang:hreflang,
            pageType:pageType,
            isError:!pageType||pageType!==currentPageType
          });
          
          // Проверяем ошибки
          if(!pageType){
            errors.push({
              type:'unknown',
              href:href,
              path:path,
              hreflang:hreflang,
              message:'URL не найден в базе слагов'
            });
          }else if(pageType!==currentPageType){
            errors.push({
              type:'mismatch',
              href:href,
              path:path,
              hreflang:hreflang,
              pageType:pageType,
              expected:currentPageType,
              message:'Неправильная страница: '+pageType+' вместо '+currentPageType
            });
          }
        });
        
        // Создаем модальное окно
        var currentUrl=window.location.href.replace(/\/+$/,'');
        var modal=document.createElement('div');
        modal.style.cssText='position:fixed!important;top:20px!important;left:20px!important;background:#fff!important;border:1px solid #ccc!important;box-shadow:0 2px 10px rgba(0,0,0,0.2)!important;z-index:999999!important;max-width:900px!important;max-height:80vh!important;overflow:auto!important;font-family:Arial,sans-serif!important;font-size:13px!important';
        
        var header=document.createElement('div');
        header.style.cssText='background:'+(errors.length>0?'#ffebee':'#e8f5e9')+'!important;padding:8px 12px!important;border-bottom:1px solid #ccc!important;display:flex!important;justify-content:space-between!important;align-items:center!important';
        
        var title=document.createElement('span');
        title.textContent='Hreflang Check: '+(errors.length>0?errors.length+' ошибок':'Всё ОК ✓');
        title.style.cssText='font-weight:bold!important;color:'+(errors.length>0?'#c62828':'#2e7d32')+'!important;font-size:14px!important';
        header.appendChild(title);
        
        var closeBtn=document.createElement('button');
        closeBtn.textContent='✕';
        closeBtn.style.cssText='background:none!important;border:none!important;font-size:16px!important;cursor:pointer!important;color:#666!important;padding:0!important;width:20px!important;height:20px!important';
        closeBtn.onclick=function(){document.body.removeChild(modal)};
        header.appendChild(closeBtn);
        modal.appendChild(header);
        
        // Показываем текущую страницу
        var currentInfo=document.createElement('div');
        currentInfo.style.cssText='padding:10px 12px!important;background:#f5f5f5!important;border-bottom:1px solid #e0e0e0!important';
        currentInfo.innerHTML='<strong>Текущая страница:</strong> '+currentPath+' <span style="color:#666">('+currentPageType+')</span>';
        modal.appendChild(currentInfo);
        
        // Таблица с результатами
        var table=document.createElement('table');
        table.style.cssText='width:100%!important;border-collapse:collapse!important';
        
        var thead=document.createElement('thead');
        thead.innerHTML='<tr style="background:#e8f0fe!important;border-bottom:1px solid #ccc!important"><th style="padding:8px 12px!important;text-align:left!important;font-weight:normal!important;color:#333!important;border-right:1px solid #ccc!important;width:40%!important">href</th><th style="padding:8px 12px!important;text-align:left!important;font-weight:normal!important;color:#333!important;border-right:1px solid #ccc!important;width:15%!important">hreflang</th><th style="padding:8px 12px!important;text-align:left!important;font-weight:normal!important;color:#333!important;width:45%!important">Статус</th></tr>';
        table.appendChild(thead);
        
        var tbody=document.createElement('tbody');
        allPages.forEach(function(page,index){
          var row=document.createElement('tr');
          var bgColor=page.isError?'#ffebee':'(index%2===0?'#fff':'#f9f9f9')';
          row.style.cssText='border-bottom:1px solid #e0e0e0!important;'+(page.isError?'background:#ffebee!important':(index%2===0?'background:#fff!important':'background:#f9f9f9!important'));
          
          var hrefCell=document.createElement('td');
          hrefCell.style.cssText='padding:8px 12px!important;border-right:1px solid #e0e0e0!important;color:#000!important;font-size:11px!important;word-break:break-all!important';
          var url=document.createElement('a');
          url.href=page.href;
          url.textContent=page.path;
          url.style.cssText='color:'+(page.isError?'#c62828':'#1558d6')+'!important;text-decoration:none!important';
          url.target='_blank';
          hrefCell.appendChild(url);
          
          var langCell=document.createElement('td');
          langCell.textContent=page.hreflang;
          langCell.style.cssText='padding:8px 12px!important;border-right:1px solid #e0e0e0!important;color:#000!important;font-weight:bold!important';
          
          var statusCell=document.createElement('td');
          statusCell.style.cssText='padding:8px 12px!important;color:#000!important;font-size:11px!important';
          
          if(page.isError){
            var error=errors.find(e=>e.path===page.path);
            statusCell.innerHTML='<span style="color:#c62828!important;font-weight:bold!important">❌ '+error.message+'</span>';
          }else{
            statusCell.innerHTML='<span style="color:#2e7d32!important">✓ OK ('+page.pageType+')</span>';
          }
          
          row.appendChild(hrefCell);
          row.appendChild(langCell);
          row.appendChild(statusCell);
          tbody.appendChild(row);
        });
        table.appendChild(tbody);
        modal.appendChild(table);
        
        // Футер с кнопками
        var footer=document.createElement('div');
        footer.style.cssText='padding:8px 12px!important;background:#f5f5f5!important;border-top:1px solid #ccc!important;display:flex!important;justify-content:space-between!important;align-items:center!important';
        
        var stats=document.createElement('span');
        stats.textContent='Всего: '+hreflangs.length+' | Ошибок: '+errors.length;
        stats.style.cssText='color:#666!important;font-size:12px!important';
        footer.appendChild(stats);
        
        var reloadBtn=document.createElement('button');
        reloadBtn.textContent='Перезагрузить страницу';
        reloadBtn.style.cssText='padding:6px 12px!important;background:#1976D2!important;color:#fff!important;border:none!important;border-radius:3px!important;cursor:pointer!important;font-size:12px!important';
        reloadBtn.onclick=function(){location.reload()};
        footer.appendChild(reloadBtn);
        
        modal.appendChild(footer);
        document.body.appendChild(modal);
      })
      .catch(function(err){
        alert('Ошибка загрузки базы слагов: '+err.message);
      });
  },500);
})();
